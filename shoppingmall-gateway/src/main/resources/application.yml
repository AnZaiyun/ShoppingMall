server:
  port: 88

spring:
  application:
    name: shoppingmall-gateway
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
    gateway:
      routes:
        - id: login
          uri: lb://renren-fast
          predicates:
            - Path=/api/sys/**,/api/captcha.jpg**
          filters:
            - RewritePath=/api/(?<segment>.*),/renren-fast/$\{segment}
        # 匹配原理,uri是重定向后的地址，根据nacos注册中心的服务名找到ip和端口
        # 当predicates断言成立时，就会将发往网关的请求重定向至配置的uri地址，其中如果filters有配置，则会根据filters的配置修改请求信息
        - id: product_category
          uri: lb://shoppingmall-product
          predicates:
            - Path=/api/product/**
          filters:
            - RewritePath=/api/(?<segment>.*),/$\{segment}
        - id: member_route
          uri: lb://shoppingmall-member
          predicates:
            - Path=/api/member/**
          filters:
            - RewritePath=/api/(?<segment>.*),/$\{segment}
        - id: third_party
          uri: lb://shoppingmall-third-party
          predicates:
            - Path=/api/thirdparty/**
          filters:
            - RewritePath=/api/thirdparty/(?<segment>.*),/$\{segment}


